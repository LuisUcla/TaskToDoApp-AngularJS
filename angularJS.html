<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Task ToDo App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js "></script>
    <script src="./controller.js"></script>
    
</head>

</head>
<body ng-app="crudApp" ng-controller="crudController">
    <div class="container pt-5 h-100" ng-init="getData()">
        <div ng-if="success" class="alert alert-success">
            {{successMessage}}
        </div>

        <div class="row h-100 p-3 d-flex" style="gap: 10px; overflow: scroll;">
            <div class="text-bg-light col-lg-12 col-sm-12 border border-secondary rounded p-3">
                <h3 class="fw-bold">Task App</h3>

                <form ng-submit="save()">
                    <input ng-model="id" name="id" type="hidden"  id="id" >

                    <div class="mb-3">
                      <label for="title" class="form-label">Title</label>
                      <input ng-model="title" name="title" placeholder="Title:" type="text" class="form-control" id="title" >
                    </div>

                    <div class="mb-3">
                      <label for="description" class="form-label">Descrption</label>
                      <textarea ng-model="description" name="description" placeholder="Description task:" type="text" class="form-control" id="description" rows="3"></textarea>
                    </div>
                   
                    <button type="submit" class="btn btn-primary">Save Task</button>
                    <button ng-click="clearModel()" type="button" class="btn btn-outline-primary">Cancel</button>
                </form>
            </div>
            <div class="text-bg-light col-lg-12 col-sm-12 border border-secondary rounded p-3">
                <h3 class="fw-bold">List</h3>
                <!-- card Task -->

                <select ng-model="editChange" ng-change="change(editChange)" class=" w-50 mb-3 form-select">
                    <option value="all" selected>All</option>
                    <option value="pending" >Pending</option>
                    <option value="completed">Completed</option>
                </select>

                <div ng-if="taskList.length > 0">
                    <div ng-repeat="task in taskList track by $index"
                        ng-class="{ 
                            'border-warning bg-warning bg-opacity-10': task.status == 'pending',
                            'border-success bg-success opacity-50 bg-gradient bg-opacity-25': task.status == 'completed'
                        }"
                        class="card cardTask shadow">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <h5 
                                    ng-Class="task.status == 'completed' ? 'text-decoration-line-through text-danger' : ''"
                                    class="card-title fw-bold"
                                >
                                    {{task.title}}
                                </h5>
                                <input
                                    ng-click="taskCompleted(task.id)"
                                    class="form-check-input text-success mt-0" 
                                    type="checkbox" 
                                    ng-checked="task.status == 'completed' ? true : false " 
                                    id="defaultCheck1"
                                >                    
                            </div>
                    
                            <p 
                                ng-Class="task.status == 'completed' ? 'text-decoration-line-through text-danger' : ''" 
                                class="card-text mb-1"
                            >
                                {{task.description}}
                            </p>
                    
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-secondary text-capitalize">{{task.status}}</small>
                                <div>
                                    <button ng-disabled="task.status !== 'pending'" ng-click="selectTaskEdit(task.id)" type="button" class="btn btn-link p-0" >
                                        <img src="./icons/edit.svg" alt="">
                                    </button>

                                    <button type="button" class="btn btn-link p-0" data-bs-toggle="modal" data-bs-target="#modalDelete" ng-click="selectTaskDelete(task.id)">
                                        <img src="./icons/trash.svg" alt="">
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-4 d-flex justify-content-center align-items-center" ng-if="taskList.length == 0">
                    <p class="fw-bold">List empty...</p>
                </div>
            </div>
        </div>  
    </div>

    <!-- modal confirm delete -->
    
    <div class="modal fade" id="modalDelete" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fw-bold fs-5" id="exampleModalLabel">Delete task</h1>
              <button  type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure to delete the task?
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">Cancel</button>
              <button ng-click="deleteTask()" type="button"  data-bs-dismiss="modal" class="btn btn-danger">Delete</button>
            </div>
          </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <style>
        input[type='checkbox'] { 
            font-size: 1.5rem;
            margin-right: 3px;
        }

        .cardTask {
            margin-bottom: 20px;
        }

        form button {
            width: 6rem;
        }
    </style>
</body>
</html>